<!DOCTYPE html>
<html lang="en_US">
<head>
    <meta charset="utf-8" />
    <title>Our first pygame - Refactoring - part 4 | Game Experiments</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta name="author" content="Richard Porteous">
    <meta name="description" content="Various coding tutorials">
    <meta name="keywords" content="blog, site, tutorials, coding, software, programming">

    
    <link href="https://richard-porteous.github.io/css/bootswatch/darkly.min.css" rel="stylesheet">
    
    <link href="https://richard-porteous.github.io/css/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://richard-porteous.github.io/css/custom.css" rel="stylesheet">

<link rel="icon" type="image/x-icon" href="https://richard-porteous.github.io/favicon.ico" />



<script type="text/javascript">
    var azbalacSettingHeaderMoveTitle = 'false';
</script>
<script src="https://richard-porteous.github.io/js/jquery-3.4.1.min.js"></script>
<script src="https://richard-porteous.github.io/js/functions.js"></script><style>body {}.footer-container { background-color: #29281f; }.footer-container { color: #f9fcf9; }</style>



<link id="typography-header-title-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Exo%3A800"><style id="typography-title" type="text/css">#site-header-text a {
        font-family: Exo;
    }#site-header-text a {
        font-size: 50px; 
    }</style>

<link id="typography-header-subtitle-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Exo%3A600"><style id="typography-subtitle" type="text/css">#site-description {
        font-family: Exo;
    }#site-description {
        font-size: 30px; 
    }</style>

<style id="typography-body" type="text/css"></style>

<style id="typography-navbar" type="text/css">nav#navbarMain {
        font-size: 20px; 
    }
    nav#navbarMain ul.dropdown-menu {
        font-size: 20px;
    }</style>

<link id="typography-headline-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans"><style id="typography-headline" type="text/css">h1, h2, h3, h4, h5, h6 {
                font-family: Open Sans; 
            }</style>



    
    <script type="text/javascript">
        var azbalacSettingHeaderColor = { 'bg': '#000000',
            'transp': '0'
            };

    </script>
    <style type="text/css">
        #site-header-text a, #site-description {
                background: "#000000";  
            background:  rgba(0,0,0,0.00);
            
        }
    </style>
    
    
    <style type="text/css">
        #site-header-box-title {
            margin-bottom: 0px;
        }
    </style>
    
    
    <style type="text/css">
        #site-header-container-overlay {
        
            left: 20px;
        
        
            top: 20px;
        
        }
    </style>
    


<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
        <script src="//cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
        <script src="//cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


</head>


<body>

<div id="header" role="banner" style="">

    <div class="container">
        <header class="masthead">
            <div>
                <div id="site-header-container-above" class="row align-items-center">
                    
                </div>
            </div>


            

            <div id="site-header-above"><a href="https://richard-porteous.github.io/" rel="home">
                <picture>
                        <source media="(min-width: 1200px)" srcset="https://richard-porteous.github.io/img/header_background.jpg 1110w">
                        <source media="(min-width: 992px) and (max-width: 1199.98px)" srcset="https://richard-porteous.github.io/img/header_background.jpg 930w">
                        <source media="(min-width: 768px) and (max-width: 991.98px)" srcset="https://richard-porteous.github.io/img/header_background.jpg 690w">
                        <source media="(min-width: 576px) and (max-width: 767.98px)" srcset="https://richard-porteous.github.io/img/header_background.jpg 510w">
                        <source media="(max-width: 575.98px)" srcset="https://richard-porteous.github.io/img/header_background.jpg 476w">
                        <img id="site-header-image" src="https://richard-porteous.github.io/img/header_background.jpg" style="max-width: 100%; width: 100%">
                </picture>
                </a>

                <div id="site-header-container-overlay" class="position-absolute  fixed-top ">
                    <div id="site-header-box-title" class=" d-flex justify-content-start ">
                        <h1 class="azbalac-title" id="site-header-text"><a class="header-url" style="color: #FFFFFF;" href="https://richard-porteous.github.io/">Game Experiments</a></h1>
                    </div>
                    
                    <div id="site-header-box-subtitle" class=" d-flex justify-content-start ">   
                        <h2 class="azbalac-subtitle" id="site-description" style="color: #EEEEFF;">Learn with me</h2>
                    </div>
                </div>
                
             
            </div>

    
    <nav id="navbarMain" class="navbar navbar-expand-sm justify-content-between mb-3 navbar-dark bg-primary" role="navigation">
        
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
        </button>
      
            
            <div class="sticky-top navbar-collapse collapse  " id="navbarSupportedContent"> 
                <ul class="navbar-nav">

  
  <li class="nav-item ">
    <a class="nav-link" href="/">
      
      Home
    </a>
  </li>
  <span class="mx-2"></span>
  

  
  <li class="nav-item ">
    <a class="nav-link" href="/posts/">
      
      Blog
    </a>
  </li>
  <span class="mx-2"></span>
  

  
  <li class="nav-item ">
    <a class="nav-link" href="/about/">
      
      About
    </a>
  </li>
  <span class="mx-2"></span>
  
</ul>
             
            </div>
        
            
    </nav> 
    



      </header>
    </div> 
</div>


    <div id="main">
        <div class="container">
            <div class="row"><div class="col-md" id="content">





<h1>Our first pygame - Refactoring - part 4</h1>

    <div class="post-meta"><span class="byline-icon fa fa-clock-o" aria-hidden="true"></span> <span class="screen-reader-text">Date: </span><time datetime="2023-11-10T13:19:53-07:00">10.11.2023</time> - 
    <span class="byline-icon fa fa-user" aria-hidden="true"></span><span class="screen-reader-text">Author: </span> Richard Porteous
     </div>


  <p>I&rsquo;d like to make a small change. I want to put the image path in a variable, for now, img_path is a good name</p>
<pre tabindex="0"><code>#Somewhere near the top of our code we will place the following
img_path = &#39;images/&#39;
#Then we replace our existing player load image code with the following concatenation
player = pygame.image.load(img_path + &#34;blue_body_square.png&#34;)
</code></pre><p>Run the app and it does the same.</p>
<p>The reason for this change is that the choice for images (or assets) tends to change. I know some who are used to Game Engines and they like having a top-level Assets folder. Well as your app grows you may need to reorganize and this is one way to do it. You may want to have several variables based on the way you organize your game objects in which case it could be &ldquo;assets/images/player/&rdquo; or &ldquo;tokens/player/images&rdquo; etc. etc.</p>
<p>If you still are writing the delta time to the terminal you will notice we are chewing up a lot of processor time and are updating our screen more than we need to. Let’s be nice to other apps and limit our frame rate maximum to 60 frames per second.</p>
<pre tabindex="0"><code># near our game_running variable we can add
clock = pygame.time.Clock()
FPS = 60


# and the top of our game loop we can add
​clock.tick(FPS)
Our game should still look the same but the delta time should have increased to about 16 or 17.


One more change - Let’s move the keypress code into its own class.
class keyisdown():
   
    def __init__(self) -&gt; None:
        self.leftkey = False
        self.rightkey = False
        self.upkey = False
        self.downkey = False
    def getEvents(self):
       
        for event in pygame.event.get():
            if event.type == QUIT:
                return False
           
            if event.type==pygame.KEYDOWN:
                if event.key in [K_s, K_DOWN]:
                    self.downkey = True
                if event.key in [K_w, K_UP]:
                    self.upkey = True
                if event.key in [K_d, K_RIGHT]:
                    self.rightkey = True
                if event.key in [K_a, K_LEFT]:
                    self.leftkey = True
               
            elif event.type==pygame.KEYUP:
                if event.key in [K_s, K_DOWN]:
                    self.downkey = False
                if event.key in [K_w, K_UP]:
                    self.upkey = False
                if event.key in [K_d, K_RIGHT]:
                    self.rightkey = False
                if event.key in [K_a, K_LEFT]:
                    self.leftkey = False
        return True
held_keys = keyisdown()


And then make these changes to the game loop.
   game_running = held_keys.getEvents()
    if held_keys.leftkey:
        player_loc = player_loc.move([-speed, 0])
    if held_keys.rightkey:
        player_loc = player_loc.move([speed, 0])
    if held_keys.upkey:
        player_loc = player_loc.move([0, -speed])
    if held_keys.downkey:
        player_loc = player_loc.move([0, speed])
​```

Here is how the final code should look
</code></pre><h1 id="the-pygame-imports-to-make-them-usable-in-our-game">the pygame imports to make them usable in our game</h1>
<p>import pygame
from pygame.locals import *</p>
<h1 id="initialize-the-pygame-code">Initialize the pygame code</h1>
<p>pygame.init()
#game globals
img_path = &lsquo;images/&rsquo;</p>
<h1 id="set-window-size">set window size</h1>
<p>size = width, height = (800, 600)
screen = pygame.display.set_mode(size)
black = (0,0,0)
white = (255,255,255)
screen.fill(black)</p>
<h1 id="update-the-display-to-see-what-we-set">update the display to see what we set</h1>
<p>pygame.display.update()
#load images
player = pygame.image.load(img_path + &ldquo;blue_body_square.png&rdquo;)
player_loc = player.get_rect()
player_loc.center = width/2, height/2</p>
<p>clock = pygame.time.Clock()
FPS = 60</p>
<h1 id="control-variable">control variable</h1>
<p>game_running = True</p>
<h1 id="time-based-movement-requires-delta-time">time based movement requires delta time</h1>
<p>class deltatime():
def <strong>init</strong>(self):
self.last_loop = pygame.time.get_ticks()
self.dt = 0</p>
<pre><code>def loop_time(self) -&gt; int:
    time_now_ms = pygame.time.get_ticks()
    dt = time_now_ms - self.last_loop
    self.last_loop = time_now_ms
    return dt
</code></pre>
<h1 id="end-of-the-class-and-code-contiues">end of the class and code contiues​</h1>
<p>delta_time = deltatime()  # we initialize the class here and can now use it as an object
class keyisdown():</p>
<pre><code>def __init__(self) -&gt; None:
    self.leftkey = False
    self.rightkey = False
    self.upkey = False
    self.downkey = False
def getEvents(self):
   
    for event in pygame.event.get():
        if event.type == QUIT:
            return False
       
        if event.type==pygame.KEYDOWN:
            if event.key in [K_s, K_DOWN]:
                self.downkey = True
            if event.key in [K_w, K_UP]:
                self.upkey = True
            if event.key in [K_d, K_RIGHT]:
                self.rightkey = True
            if event.key in [K_a, K_LEFT]:
                self.leftkey = True
           
        elif event.type==pygame.KEYUP:
            if event.key in [K_s, K_DOWN]:
                self.downkey = False
            if event.key in [K_w, K_UP]:
                self.upkey = False
            if event.key in [K_d, K_RIGHT]:
                self.rightkey = False
            if event.key in [K_a, K_LEFT]:
                self.leftkey = False
    return True
</code></pre>
<p>held_keys = keyisdown()</p>
<h1 id="game-loop">GAME LOOP</h1>
<p>while game_running:
clock.tick(FPS)
# indicating the number of miliseconds since the last time that piece of code was run
dt = delta_time.loop_time()
speed = 1 * dt
print(dt) #remove this line when coding your game</p>
<pre><code>game_running = held_keys.getEvents()
if held_keys.leftkey:
    player_loc = player_loc.move([-speed, 0])
if held_keys.rightkey:
    player_loc = player_loc.move([speed, 0])
if held_keys.upkey:
    player_loc = player_loc.move([0, -speed])
if held_keys.downkey:
    player_loc = player_loc.move([0, speed])
screen.fill(black)
# place image on the screen
screen.blit(player, player_loc)
# apply changes
pygame.display.update()
</code></pre>
<h1 id="quit-the-pygame-window">quit the pygame window</h1>
<p>pygame.quit()
#the app exits</p>
<pre tabindex="0"><code></code></pre>

                </div>
                    <aside class="col-md-3 tikva-sidebar">
  


    

        <div class="col">
    <div class="p-3 mb-3 bg-light rounded">
    <h4>Coming Soon</h4>
   
    <p>    </p>
   
    </div>
</div>

    

        <div class="col">
    <div class="p-3 mb-3 bg-light rounded">
    <h4>New(ish) Site</h4>
   
    <p>    <p>I&rsquo;ve been busy moving the old sites content to these HUGO static pages. More will change soon.</p>
</p>
   
    </div>
</div>

    

</aside>
</div>
        </div>
    </div>

    
        <div class="footer-container" style="">
    <div class="container">
        <footer>

            <div class="row">
            
            
                
                    <div class="col">
    <!-- raw HTML omitted -->
<!-- raw HTML omitted -->

</div>
                
                    <div class="col">
    
</div>
                
                    <div class="col">
    
</div>
                
            

            </div>
        </footer>
    </div>
</div>
    
    
        
<div class="subfooter-container">

    <div class="container">
        <div class="footer">
            <div class="row wrapper padding">
                <div class="col-xs-12 col-md-12">

            
            
                
                        <p>Powered by <a href="https://gohugo.io">Hugo</a>. Theme <a href="https://github.com/geschke/hugo-tikva">Tikva</a> by <a href="https://www.kuerbis.org">Ralf Geschke</a>.</p>


                
            
                  
                </div>
            </div>
        </div>
    </div>
</div>

    

    <div id="media-width-detection-element"></div>

<script src="https://richard-porteous.github.io/js/popper.min.js"></script>
<script src="https://richard-porteous.github.io/js/bootstrap.min.js"></script>


</body>
</html>